---
layout: post
title: "C#创建非矩形窗体"
date: 2017-7-24 12:30
comments: true
toc: true
tags:
  - 2017-7
  - C#
  - 教程
---

##### 简 介

<font color=gray size=2 face="微软雅黑">示例：</font>
![](/assets/blogImg/DP-170724-0.png)

1、 C#根据含透明色的图片创建非矩形窗体

2、 鼠标左键控制该窗体的移动

<font style="color:green">（转载请注明出处）</font></br>

<!--more-->

##### 具体操作

1、 在新建立的窗体中拖入PictureBox控件

2、 设置好PictureBox的图片来源

3、 其属性SizeMode设置为StretchImage（拉伸）

4、 设置窗体背景色透明，在窗体加载事件中添加如下代码：

``` csharp
this.TransparencyKey = Color.White;             //设置当前窗体的默认透明色  
this.BackColor = this.TransparencyKey;          //设置当前窗体的背景色为透明  
this.FormBorderStyle = FormBorderStyle.None;    //设置窗体无边框

```

5、 让鼠标控制窗体的移动（详细代码见后文）
 * 首先创建一个Point对象downPoint（用于记录鼠标移动前的坐标）
 * 然后在PictureBox的MouseDown事件中将鼠标移动前的坐标e.Location赋值给downPoint
 * 最后，在pictureBox的MouseMove事件中先判断当前按键是否为鼠标左键，若是，则通过鼠标移动前的坐标和移动后的坐标生成新的坐标赋值给当前的窗体



##### 代 码

``` csharp
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace MainFrm
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }
        private void Form1_Load(object sender, EventArgs e)
        {
            this.TransparencyKey = Color.White;             //设置当前窗体的默认透明色  
            this.BackColor = this.TransparencyKey;          //设置当前窗体的背景色为透明  
            this.FormBorderStyle = FormBorderStyle.None;    //设置窗体无边框
        }

        Point downPoint;   //用于记录鼠标移动前的位置

        private void pictureBox1_MouseDown(object sender, MouseEventArgs e)
        {//将鼠标移动前的位置赋值给downPoint
            downPoint = e.Location;
        }
        private void pictureBox1_MouseMove(object sender, MouseEventArgs e)
        {
            if (e.Button==MouseButtons.Left)
            {//通过鼠标的移动前和移动后的坐标生成新的坐标
                Location = new Point(Location.X + e.X - downPoint.X, Location.Y + e.Y - downPoint.Y);   
            }
        }
    }
}

```

*（本页地址：http://solutionx.top/2017/07/24/diary-170724-1/ ） *
