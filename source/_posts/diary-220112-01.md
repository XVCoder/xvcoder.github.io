---
layout: post
title: "Windows配置端口转发"
date: 2022-01-12 00:00
comments: true
toc: true
tags:
  - 2022-01
  - Windows
  - 网络
  - 教程
---

本教程介绍Windows下使用自带工具配置端口转发（映射）。

<!--more-->

---

#### 【创建端口转发】
``` powershell
PS> netsh interface portproxy add v4tov4 listenaddress=192.168.1.100 listenport=33890 connectaddress=192.168.1.101 connectport=3389
```
| 参数          | 说明                                                         |
| ------------- | ------------------------------------------------------------ |
| listenaddress | 监听地址，如果本机有多个地址，且需要监听所有地址，此参数可以省略。 |
| listenport    | 监听端口，用于监听网络请求的端口。                              |
| connectaddress| 连接地址，用于转发网络请求的地址。                              |
| connectport   | 连接端口，用于转发网络请求的端口。                              |

``` powershell
# 上述命令可以简写为：
PS> netsh interface portproxy add v4tov4 listenport=33890 connectaddress=192.168.1.101 connectport=3389
```

> 说明：以上命令设置本地监听端口 33890，转发到 192.168.1.101:3389

---

#### 【查看端口转发规则】
``` powershell
# 显示所有转发规则
PS> netsh interface portproxy show all

# 仅显示 IPv4ToIPv4 的转发规则
PS> netsh interface portproxy show v4tov4

# 仅显示 IPv6ToIPv6 的转发规则
PS> netsh interface portproxy show v6tov6

# 仅显示 IPv4ToIPv6 的转发规则
PS> netsh interface portproxy show v4tov6

# 仅显示 IPv6ToIPv4 的转发规则
PS> netsh interface portproxy show v6tov4
```

---

#### 【删除端口转发规则】
``` powershell
# 如果在创建端口转发规则的时候有 listenaddress ，在删除的时候需要加上 listenaddress
PS> netsh interface portproxy delete v4tov4 listenaddress=192.168.1.100 listenport=33890

# 如果在创建端口转发规则的时候没有 listenaddress ，在删除的时候不用加 listenaddress
PS> netsh interface portproxy delete v4tov4 listenport=33890
 ```