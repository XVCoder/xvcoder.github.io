---
layout: post
title: "Windows下安装配置MinIO"
date: 2022-05-31 00:00
comments: true
toc: true
tags:
  - 2022-05
  - Windows
  - 分布式对象存储
  - MinIO
  - 教程
---

本教程介绍在Windows下安装配置MinIO。（包括直接运行+配置成服务）

<!--more-->

---

#### 【手动运行MinIO】

##### 1、准备
创建放置minio可执行文件的目录（例：E:\MinIO）

##### 2、运行Powershell，下载安装包、配置环境变量、手动运行MinIO
● 执行以下命令下载minio安装包到上一步创建的文件夹中（也可以访问https://dl.min.io/server/minio/release/windows-amd64/minio.exe直接下载）


``` powershell
PS> Invoke-WebRequest -Uri "https://dl.min.io/server/minio/release/windows-amd64/minio.exe" -OutFile "E:\MinIO\minio.exe"
```

● 执行以下命令设置环境用户名和密码的环境变量
``` powershell
PS> setx MINIO_ROOT_USER minioadmin
PS> setx MINIO_ROOT_PASSWORD asdf@123
```

● 执行以下命令手动运行MinIO
``` powershell
PS> E:\MinIO\minio.exe server E:\MinIO\data --address=:12000 --console-address=:12001
```

> 参数说明：  
--address  定义api监听的地址（默认端口为9000）  
--console-address  定义网页控制台监听的地址（默认端口为9001）

---

#### 【配置成服务】
> 借助winsw将MinIO配置成服务，其他程序也可以参考此方法

##### 1、下载winsw（https://github.com/winsw/winsw/releases）
##### 2、将WinSW-x64.exe复制到放置minio.exe的目录E:\MinIO，将WinSW-x64.exe重命名为MinioService.exe
##### 3、在目录E:\MinIO中创建MinioService.xml文件，编辑内容如下
``` powershell
<service>
    <!-- 设置服务Id -->
    <id>MinioService</id>
    <!-- 设置服务名称 -->
    <name>MinioService</name>
    <!-- 设置服务描述 -->
    <description>MinioService</description>
    <!-- 设置环境变量 -->
    <env name="HOME" value="%BASE%"/>
    <!-- 设置执行对象 -->
    <executable>%BASE%\minio.exe</executable>
    <!-- 设置执行参数 -->
    <arguments>server "%BASE%\data" --address=:12000 --console-address=:12001</arguments>
    <!-- 设置日志模式 -->
    <logmode>rotate</logmode>
    <!-- 设置日志路径 -->
    <logpath>%BASE%\logs</logpath>
    <!-- 设置日志参数 -->
    <log mode="roll-by-size-time">
      <!-- 设置切割阈值 -->
      <sizeThreshold>10240</sizeThreshold>
      <!-- 设置日期格式 -->
      <pattern>yyyyMMdd</pattern>
      <!-- 设置切割时间 -->
      <autoRollAtTime>00:00:00</autoRollAtTime>
      <!-- 设置生命周期 -->
      <zipOlderThanNumDays>5</zipOlderThanNumDays>
      <!-- 设置压缩格式 -->
      <zipDateFormat>yyyyMMdd</zipDateFormat>
    </log>
</service>
```

##### 4、在.exe文件所在目录下运行CMD或PowerShell，执行以下命令完成 [安装/卸载服务] 的操作
``` powershell
# 安装服务
.\MinioService.exe install

# 卸载服务
.\MinioService.exe uninstall

# 启动服务
net start MinioService

# 停止服务
net stop MinioService
```

##### 5、修改用户名或密码（默认均为minioadmin，手动安装也可以通过以下方式修改）
① 服务安装完成后，在E:\MinIO\data目录下有一个.minio.sys目录，进到这个目录，编辑config.json文件
② 搜索 access_key 和 secret_key 并将其修改为自定义的值
③ Win+R> 运行 services.msc，找到MinioService，右键重启服务

> 参考文档：  
1、MinIO注册成服务 https://blog.csdn.net/weixin_41137835/article/details/114888202  
2、MinIO修改密码 https://blog.csdn.net/weixin_44981485/article/details/106809902 