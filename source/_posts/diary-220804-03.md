---
layout: post
title: "IdentityServer4 - 入门"
date: 2022-08-04 20:59:06
comments: true
toc: true
tags:
  - 2022-08
  - IdentityServer4
  - ASP.NET Core
---

#### 【Identity Server 4】
官网：https://identityserver4.readthedocs.io/en/latest/index.html

[概述]
是一个 OpenID Connect provider → 它实现了 OpenID Connect 和 OAuth 2.0 两个协议

主要职责  
1、保护资源  
2、认证用户（可使用本地账户或外部的 Identity Provider，如使用微信、github登录）  
3、可提供会话管理和单点登录（SSO）  
4、管理和认证客户端  
5、给客户端发行 identity 和 access token  
6、验证 tokens  

------------------------------------------------------------------------------------------

#### 【实际应用举例】

1、保护客户端（值守）  
OAuth 2.0 Client Credentials  
当应用请求access token访问它们所拥有的资源时使用，不代表用户。  

2、保护WPF客户端（用户登录）  
OAuth 2.0 Password Grant  

------------------------------------------------------------------------------------------

#### 【启动一个将数据存到内存的模板】（仅适用于测试或对安全性要求不高的项目）  
1、安装模板  
``` powershell
PS> dotnet new -i identityserver4.templates  
```

2、查看已安装的模板  
``` powershell
PS> dotnet new --list
```

IdentityServer4提供的模板有如下几类
``` powershell
IdentityServer4 Empty                                 is4empty  [C#]  Web/IdentityServer4
IdentityServer4 Quickstart UI (UI assets only)        is4ui     [C#]  Web/IdentityServer4
IdentityServer4 with AdminUI                          is4admin  [C#]  Web/IdentityServer4
IdentityServer4 with ASP.NET Core Identity            is4aspid  [C#]  Web/IdentityServer4
IdentityServer4 with Entity Framework Stores          is4ef     [C#]  Web/IdentityServer4
IdentityServer4 with In-Memory Stores and Test Users  is4inmem  [C#]  Web/IdentityServer4
```

3、启动一个在内存中存储数据且包含测试用户的模板
``` powershell
PS> dotnet new is4inmem --name IdentityServer.MemoryTemplate.Test
```

------------------------------------------------------------------------------------------