---
layout: post
title: WPF TreeViewItem中某一元素的属性变化时更改其他元素的属性
date: 2023-01-07 22:57:40
comments: true
toc: true
tags:
  - 2023-01
  - WPF
  - TreeViewItem
  - DataTrigger
---

最近用WPF写一个小工具的时候用到了TreeView，想实现如下效果，当鼠标进入到当前节点时，自动显示用于展开下拉菜单的按钮。  

![效果图](/assets/blogImg/DP-230107-01.gif)  

<!--more-->

废话不多说，直接上代码：  

``` csharp
<!--注意，此处省略了部分与效果实现无关的属性，只需参考DataTrigger部分的代码即可-->
<TreeView>
  <TreeView.ItemTemplate>
    <HierarchicalDataTemplate>
        <Grid>
          <!--此处省略其他UI元素-->
          <Button Content="···">
            <Button.Resources>
              <Style TargetType="Button"
                     BasedOn="{StaticResource {x:Type Button}}">
                <Setter Property="Background"
                        Value="Transparent" />
                <Setter Property="Foreground"
                        Value="Transparent" />
                  <Style.Triggers>
                    <DataTrigger Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor,AncestorLevel=1,AncestorType=Grid},Path=IsMouseOver}"
                                 Value="True">
                    <Setter Property="Foreground"
                            Value="Black" />
                      </DataTrigger>
                  </Style.Triggers>
              </Style>
            </Button.Resources>
          </Button>
        </Grid>
    </HierarchicalDataTemplate>
  </TreeView.ItemTemplate>
</TreeView>
```

代码解读：  
以上Button元素绑定了一个 DataTrigger，用于监听上一层（通过AncestorLevel=1设置）Grid 元素的 IsMouseOver 属性。当 IsMouseOver 为 True，也就是鼠标移动到 Grid 上方时，设置 Button 的 Foreground 属性值为 Black，否则用默认值 Transparent。  

最终实现的效果也就类似于上方动图啦。  